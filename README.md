# bcc

Beautiful C Compiler. A simple C(subset of C) compiler.

## Directory

./src -- Source code.
    ./lexer.l -- Lexical analyzer.
    ./parser.y -- Grammar analyzer.
    ./utility.h/cpp -- Utility code file.
    ./type.h/cpp -- Type code file.
    ./tree.h/cpp -- Syntax tree and symbol table code file.
    ./translater.h/cpp -- Translater which translater C code to AT&T x86 assembly code.
    ./common.h -- Header file
    ./pch.h -- Header file
./test -- Test files.
    ./1 -- Level 1 test files.
    ./2 -- Level 2 test files.
    ./3 -- Level 3 test files.
    ./4 -- Level 4 test files.
    ./type_check -- Type check test files.
    ./mytest -- Temporary test files to debug.
./test.out -- Sample output file.
./main.out -- Output of `make` command.
./err.log -- Log file of error output while testing using `make l1`, `make l2`, `make l3`, `make l4` or `make type`.

## Test Files

Each test point has a fixed rule of test file name. For example, the first test point "00_main"'s test files are as below.

- `00_main.c` C source code file.
- `file.in` Input of this test point.
- `file.output` My output.
- `file.s` Assembly translated by my program.
- `file.out` Compiler generated by my program.
- `file_std.out` Program compiled by reference compiler.
- `file_std.output` Reference output.

## Commands
- `make` Compile my Code and generate a C compile
    - Default platform is `x86`.
    - Default output Compiler program is at `./main.out`. 
    - Default command is `./main.out <file.c >file.s`.
    - Default command to translate C code to assembly is `gcc file.s -m32 -o file.out`.
    - Default command to test is `qemu-i386 file.out <file.in >file.output`.
    - Error output will be written into `err.log`.
- `make arm` Target platform is arm.
    - Command to translate C code to assembly is changed into `arm-linux-gnueabi-gcc -static file.s -o file.out`.
    - Command to test is changed into `qemu-arm file.out <file.in >file.output`.
- `make l1/2/3/4` Test my code in different level.
- `make arm-l1/2/3/4` Test my code in different level on arm.
- `make noerrlog` Print all errors on screen.
- `make type` Test "type check".
- `make clean` Clean work directory.

## Procedure
- Print current settings.
- Generate standard output.
- Generate assembly by my compiler.
- Translate assembly to machine code and link with gcc.
- Compare output.